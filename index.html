<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khalid & Salma Lovely Wedding</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;500&family=El+Messiri:wght@400;700&family=Reem+Kufi&family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp, getDocs, query, where, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDczRATNnQOBJHF1D9EDdhQHee3dbfDKg4",
            authDomain: "mohamed-kholoud-wedding.firebaseapp.com",
            projectId: "mohamed-kholoud-wedding",
            storageBucket: "mohamed-kholoud-wedding.firebasestorage.app",
            messagingSenderId: "113692483577",
            appId: "1:113692483577:web:87688e5eaf40ffe22ea728"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Make Firebase available globally
        window.firebaseApp = app;
        window.firestore = db;
        window.firebaseModules = { collection, addDoc, serverTimestamp, getDocs, query, where, orderBy };
        
        console.log("Firebase initialized successfully");
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #8B4513; /* Changed to warm brown */
            --secondary: #C19A6B; /* Changed to gold/brown */
            --accent: #D4AF37; /* Changed to metallic gold */
            --dark: #5D4037; /* Changed to dark brown */
            --light: #F5EBDC; /* Changed to cream */
            --gold-glow: 0 0 20px rgba(212, 175, 55, 0.7); /* Enhanced gold glow */
            --door-primary: #8B4513; /* Wood color */
            --door-secondary: #D4AF37; /* Gold accents */
            --door-accent: #5D4037; /* Dark brown details */
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #F5EBDC 0%, #E8D9C5 100%);
            color: var(--dark);
            overflow-x: hidden;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Language Switcher - Enhanced */
        .language-switcher {
            position: fixed;
            top: 10px;
            left: 10px;
            z-index: 1000;
            background: rgba(245, 235, 220, 0.95);
            border-radius: 50px;
            padding: 8px 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(193, 154, 107, 0.3);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.4s ease;
        }

        .language-switcher:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
        }

        .lang-btn {
            background: transparent;
            border: 2px solid var(--secondary);
            color: var(--dark);
            padding: 6px 12px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 0.85rem;
            position: relative;
            overflow: hidden;
        }

        .lang-btn.active {
            background: var(--secondary);
            color: white;
            box-shadow: 0 0 15px rgba(193, 154, 107, 0.7);
            transform: scale(1.05);
        }

        .lang-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: all 0.5s ease;
        }

        .lang-btn:hover::before {
            left: 100%;
        }

        .lang-btn:hover {
            transform: scale(1.05);
        }

        /* Music Player */
        .music-player {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            background: rgba(245, 235, 220, 0.95);
            border-radius: 50px;
            padding: 8px 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(193, 154, 107, 0.3);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.4s ease;
        }

        .music-player.playing {
            border-color: rgba(193, 154, 107, 0.7);
            box-shadow: 0 4px 12px rgba(193, 154, 107, 0.3);
        }

        .music-toggle {
            background: linear-gradient(135deg, var(--secondary), #A67C52);
            color: white;
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(193, 154, 107, 0.4);
            font-size: 0.9rem;
        }

        .music-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(193, 154, 107, 0.6);
        }

        .music-text {
            font-size: 0.8rem;
            color: var(--dark);
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .music-loading {
            display: none;
            font-size: 0.7rem;
            color: var(--accent);
            font-style: italic;
        }

        /* Header Section */
        header {
            text-align: center;
            padding: 40px 15px;
            background: linear-gradient(rgba(93, 64, 55, 0.85), rgba(93, 64, 55, 0.85)), 
                        url('https://images.unsplash.com/photo-1537633552985-df8429e8048b?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            border-radius: 15px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .magic-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--accent);
            border-radius: 50%;
            opacity: 0;
            animation: float 15s infinite linear;
            box-shadow: var(--gold-glow);
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        .couple-names {
            font-family: 'Dancing Script', cursive;
            font-size: 3.5rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 2;
            background: linear-gradient(to right, #C19A6B, #D4AF37, #C19A6B);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: nameGlow 3s ease-in-out infinite alternate;
        }

        .couple-names.arabic {
            font-family: 'Amiri', serif;
            font-size: 3.5rem;
            background: linear-gradient(to right, #C19A6B, #D4AF37, #C19A6B, #D4AF37, #C19A6B);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 15px rgba(193, 154, 107, 0.7), 0 0 30px rgba(193, 154, 107, 0.5);
            position: relative;
            letter-spacing: 2px;
            line-height: 1.4;
        }

        @keyframes nameGlow {
            0% {
                text-shadow: 0 0 10px rgba(193, 154, 107, 0.5);
            }
            100% {
                text-shadow: 0 0 20px rgba(193, 154, 107, 0.8), 0 0 30px rgba(193, 154, 107, 0.6);
            }
        }

        .wedding-date {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            margin-bottom: 20px;
            letter-spacing: 2px;
            position: relative;
            z-index: 2;
            color: var(--accent);
        }

        .wedding-date.arabic {
            font-family: 'Amiri', serif;
            letter-spacing: 0;
            font-size: 1.8rem;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
            line-height: 1.6;
        }

        /* MAGICAL COUNTDOWN COMPLETION STYLES */
        .countdown {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 25px 0;
            position: relative;
            z-index: 2;
            transition: transform 0.5s ease, opacity 0.5s ease;
        }

        .countdown.completed {
            animation: countdownExplode 1.5s ease forwards;
        }

        @keyframes countdownExplode {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.8;
            }
            100% {
                transform: scale(0);
                opacity: 0;
                display: none;
            }
        }

        .countdown-item {
            background: rgba(245, 235, 220, 0.15);
            padding: 12px;
            border-radius: 10px;
            min-width: 70px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(212, 175, 55, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .countdown-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .countdown-number {
            font-size: 1.8rem;
            font-weight: 700;
            display: block;
            color: var(--accent);
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .countdown-label {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: rgba(245, 235, 220, 0.9);
        }

        /* WEDDING DAY CELEBRATION ANIMATION */
        .wedding-celebration {
            position: relative;
            width: 100%;
            height: 200px;
            display: none;
            overflow: visible;
            margin: 30px 0;
        }

        .celebration-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 20px;
            opacity: 0;
            animation: fadeInCelebration 2s ease forwards 0.5s;
        }

        @keyframes fadeInCelebration {
            to { opacity: 1; }
        }

        .celebration-title {
            font-family: 'Dancing Script', cursive;
            font-size: 3rem;
            color: var(--accent);
            text-align: center;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(212, 175, 55, 0.8), 0 0 40px rgba(212, 175, 55, 0.6);
            animation: titleGlow 3s infinite alternate;
        }

        @keyframes titleGlow {
            0% {
                text-shadow: 0 0 20px rgba(212, 175, 55, 0.8), 0 0 40px rgba(212, 175, 55, 0.6);
            }
            100% {
                text-shadow: 0 0 30px rgba(212, 175, 55, 1), 0 0 60px rgba(212, 175, 55, 0.8), 0 0 80px rgba(212, 175, 55, 0.6);
            }
        }

        .celebration-title.arabic {
            font-family: 'Amiri', serif;
            font-size: 3.5rem;
            line-height: 1.6;
        }

        .celebration-subtitle {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            color: white;
            text-align: center;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .celebration-subtitle.arabic {
            font-family: 'Amiri', serif;
            font-size: 1.8rem;
            line-height: 1.6;
        }

        /* Celebration Elements */
        .celebration-sparkle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--accent);
            border-radius: 50%;
            box-shadow: 0 0 15px var(--accent);
            opacity: 0;
            animation: sparklePop 2s infinite;
        }

        @keyframes sparklePop {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(0);
                opacity: 0;
            }
        }

        .celebration-ring {
            position: absolute;
            width: 60px;
            height: 60px;
            border: 3px solid var(--accent);
            border-radius: 50%;
            box-shadow: 0 0 30px var(--accent);
            opacity: 0;
            animation: ringFloat 4s infinite;
        }

        @keyframes ringFloat {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 0.3;
            }
            50% {
                transform: translateY(-20px) rotate(180deg);
                opacity: 0.7;
            }
            100% {
                transform: translateY(0) rotate(360deg);
                opacity: 0.3;
            }
        }

        .celebration-heart {
            position: absolute;
            font-size: 24px;
            color: #C19A6B;
            opacity: 0;
            animation: heartFloat 6s infinite linear;
        }

        @keyframes heartFloat {
            0% {
                transform: translateY(0) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.8;
            }
            90% {
                opacity: 0.8;
            }
            100% {
                transform: translateY(-100px) translateX(50px) rotate(360deg);
                opacity: 0;
            }
        }

        .celebration-firework {
            position: absolute;
            width: 5px;
            height: 5px;
            background: var(--accent);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--accent);
            opacity: 0;
        }

        .invitation-text {
            font-size: 1rem;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
            position: relative;
            z-index: 2;
        }

        .invitation-text.arabic {
            font-family: 'Amiri', serif;
            direction: rtl;
            font-size: 1.2rem;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
            line-height: 1.8;
        }

        /* Location Section */
        .location-section {
            background: white;
            padding: 30px 15px;
            margin-bottom: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #F5EBDC 0%, #ffffff 100%);
        }

        .location-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 25px;
            max-width: 100%;
            margin: 0 auto;
        }

        .location-content {
            flex: 1;
            width: 100%;
            text-align: center;
        }

        .location-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: var(--dark);
            position: relative;
        }

        .location-title.arabic {
            font-family: 'Amiri', serif;
            direction: rtl;
            font-size: 2.2rem;
            background: linear-gradient(to right, #C19A6B, #5D4037, #C19A6B);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.6;
        }

        .location-title:after {
            content: '';
            display: block;
            width: 80px;
            height: 2px;
            background: var(--secondary);
            margin: 12px auto;
        }

        .magic-card {
            background: linear-gradient(120deg, #ffffff, #F8F4EC);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(193, 154, 107, 0.2);
            position: relative;
            transition: transform 0.4s ease, box-shadow 0.4s ease;
        }

        .magic-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15), var(--gold-glow);
        }

        .event-icon {
            font-size: 2.5rem;
            color: var(--secondary);
            margin-bottom: 20px;
            text-shadow: var(--gold-glow);
            animation: ringPulse 2s infinite;
        }

        @keyframes ringPulse {
            0% {
                transform: scale(1) rotate(0deg);
            }
            50% {
                transform: scale(1.1) rotate(5deg);
            }
            100% {
                transform: scale(1) rotate(0deg);
            }
        }

        .event-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--dark);
        }

        .event-title.arabic {
            font-family: 'Amiri', serif;
            direction: rtl;
            font-size: 1.8rem;
            line-height: 1.6;
        }

        .event-details {
            font-size: 1rem;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .event-details.arabic {
            font-family: 'Amiri', serif;
            direction: rtl;
            font-size: 1.2rem;
            line-height: 1.8;
        }

        .event-details p {
            margin-bottom: 8px;
        }

        .location-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--primary);
            text-decoration: none;
            font-weight: bold;
            margin-top: 12px;
            padding: 10px 20px;
            border: 2px solid var(--primary);
            border-radius: 50px;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .location-link:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(139, 69, 19, 0.4);
        }

        .location-image {
            width: 100%;
            height: 250px;
            background: url('https://images.unsplash.com/photo-1537633552985-df8429e8048b?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            border-radius: 10px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
            animation: floatImage 6s ease-in-out infinite;
        }

        @keyframes floatImage {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        .location-image:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(193, 154, 107, 0.2), rgba(212, 175, 55, 0.2));
            z-index: 1;
        }

        /* Magical Message Gallery Styles - Enhanced (Always visible after doors open) */
        .magic-message-gallery {
            display: none; /* Initially hidden, will be shown after doors open */
            margin: 40px 0;
            padding: 30px 15px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            background: linear-gradient(135deg, #F5EBDC 0%, #ffffff 100%);
            position: relative;
            overflow: hidden;
            animation: fadeInGallery 0.8s ease forwards;
        }

        @keyframes fadeInGallery {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .magic-message-gallery::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://images.unsplash.com/photo-1537633552985-df8429e8048b?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            opacity: 0.05;
            z-index: 0;
        }

        .magic-message-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            text-align: center;
            margin-bottom: 30px;
            color: var(--dark);
            position: relative;
            z-index: 1;
        }

        .magic-message-title.arabic {
            font-family: 'Amiri', serif;
            direction: rtl;
            font-size: 2.2rem;
            line-height: 1.6;
        }

        .magic-message-title:after {
            content: '';
            display: block;
            width: 80px;
            height: 2px;
            background: var(--secondary);
            margin: 12px auto;
        }

        .magic-message-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
            position: relative;
            z-index: 1;
        }

        .magic-message-box {
            background: linear-gradient(135deg, #F5EBDC, #F8F4EC);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(193, 154, 107, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.6s ease forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        .magic-message-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15), var(--gold-glow);
        }

        .magic-message-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, var(--secondary), var(--accent));
        }

        .magic-message-box::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(193, 154, 107, 0.05), rgba(212, 175, 55, 0.05));
            z-index: -1;
        }

        .magic-message-author {
            font-weight: bold;
            color: var(--dark);
            margin-bottom: 10px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .magic-message-author.arabic {
            direction: rtl;
            font-family: 'Amiri', serif;
            font-size: 1.2rem;
            line-height: 1.6;
        }

        .magic-message-author i {
            color: var(--secondary);
        }

        .magic-message-content {
            color: var(--dark);
            line-height: 1.6;
            font-size: 0.95rem;
            position: relative;
        }

        .magic-message-content.arabic {
            direction: rtl;
            text-align: right;
            font-family: 'Amiri', serif;
            font-size: 1.1rem;
            line-height: 1.8;
        }

        .magic-message-date {
            font-size: 0.8rem;
            color: var(--primary);
            margin-top: 10px;
            text-align: right;
        }

        .magic-message-date.arabic {
            direction: rtl;
            text-align: left;
            font-family: 'Amiri', serif;
        }

        .magic-message-star {
            position: absolute;
            top: 10px;
            right: 10px;
            color: var(--accent);
            font-size: 0.9rem;
            animation: twinkle 2s infinite;
        }

        @keyframes twinkle {
            0% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
            100% { opacity: 0.5; transform: scale(1); }
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .no-messages {
            text-align: center;
            padding: 40px;
            color: var(--primary);
            font-style: italic;
            grid-column: 1 / -1;
        }

        .no-messages.arabic {
            font-family: 'Amiri', serif;
            direction: rtl;
            font-size: 1.2rem;
            line-height: 1.8;
        }

        /* Message Form */
        .message-form {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-top: 40px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 1rem;
        }

        .form-group.arabic {
            direction: rtl;
            text-align: right;
        }

        .form-group.arabic label {
            font-family: 'Amiri', serif;
            font-size: 1.2rem;
            line-height: 1.6;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: 'Poppins', sans-serif;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            background: #f9f9f9;
        }

        .form-control.arabic {
            font-family: 'Amiri', serif;
            direction: rtl;
            text-align: right;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .form-control:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(193, 154, 107, 0.2);
            background: white;
        }

        .btn {
            display: inline-block;
            background: linear-gradient(135deg, var(--secondary), #A67C52);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(193, 154, 107, 0.4);
            width: 100%;
        }

        .btn.arabic {
            font-family: 'Amiri', serif;
            font-size: 1.2rem;
            line-height: 1.6;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(193, 154, 107, 0.6);
            background: linear-gradient(135deg, #A67C52, var(--secondary));
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Success/Error Messages */
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
            border: 1px solid #c3e6cb;
            display: none;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
            border: 1px solid #f5c6cb;
            display: none;
        }

        /* Limit Message */
        .limit-message {
            background: #fff3cd;
            color: #856404;
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
            border: 1px solid #ffeaa7;
            display: none;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 25px 15px;
            background: var(--dark);
            color: white;
            border-radius: 10px;
            margin-top: 25px;
            position: relative;
            overflow: hidden;
        }

        .footer-text {
            font-family: 'Dancing Script', cursive;
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--accent);
        }

        .footer-text.arabic {
            font-family: 'Amiri', serif;
            font-size: 1.8rem;
            background: linear-gradient(to right, #C19A6B, #D4AF37, #C19A6B);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.6;
        }

        /* Magic Elements */
        .floating-hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .heart {
            position: absolute;
            font-size: 16px;
            color: rgba(193, 154, 107, 0.15);
            animation: float-heart 15s infinite linear;
        }

        @keyframes float-heart {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.5;
            }
            90% {
                opacity: 0.5;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Section Title */
        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            text-align: center;
            margin: 30px 0 15px;
            color: var(--dark);
            position: relative;
        }

        .section-title:after {
            content: '';
            display: block;
            width: 80px;
            height: 2px;
            background: var(--secondary);
            margin: 12px auto;
        }

        /* Special hearts for form submission */
        .celebration-hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .celebration-heart {
            position: absolute;
            font-size: 24px;
            color: rgba(193, 154, 107, 0.8);
            animation: celebration-float 3s ease-out forwards;
            z-index: 1001;
        }

        @keyframes celebration-float {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) scale(1.5);
                opacity: 0;
            }
        }

        /* Enhanced View Messages Animation */
        .magic-glow {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(193,154,107,0.2) 0%, rgba(193,154,107,0) 70%);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .magic-message-gallery.active .magic-glow {
            opacity: 1;
        }

        /* ---------------------------------------------------- */
        /* CUSTOMIZED MAGICAL DOOR STYLES - FIXED VERSION */
        /* ---------------------------------------------------- */
        #door-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #5D4037 0%, #3E2723 100%);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            opacity: 1;
            transition: opacity 1.5s ease-out;
        }

        .left-door, .right-door {
            position: absolute;
            top: 0;
            width: 50%;
            height: 100%;
            transition: transform 1.5s cubic-bezier(0.5, 0, 0.5, 1);
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            padding: 50px 0;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.8) inset;
        }

        .left-door {
            left: 0;
            transform-origin: left center;
            background: linear-gradient(135deg, var(--door-primary) 0%, #A0522D 100%);
            border-right: 20px solid var(--door-accent);
            border-top-right-radius: 10px;
            border-bottom-right-radius: 10px;
        }

        .right-door {
            right: 0;
            transform-origin: right center;
            background: linear-gradient(225deg, var(--door-primary) 0%, #A0522D 100%);
            border-left: 20px solid var(--door-accent);
            border-top-left-radius: 10px;
            border-bottom-left-radius: 10px;
        }
        
        /* Door Wood Texture */
        .left-door::before, .right-door::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 30px,
                    rgba(61, 28, 13, 0.1) 30px,
                    rgba(61, 28, 13, 0.1) 35px
                ),
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 100px,
                    rgba(61, 28, 13, 0.15) 100px,
                    rgba(61, 28, 13, 0.15) 105px
                );
            opacity: 0.8;
            mix-blend-mode: multiply;
        }

        /* Gold Accents */
        .left-door::after, .right-door::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, 
                rgba(212, 175, 55, 0.3) 0%, 
                rgba(212, 175, 55, 0.1) 50%, 
                rgba(212, 175, 55, 0.3) 100%);
            z-index: 1;
        }

        /* Enhanced Gold Hinges/Accents */
        .hinge-top, .hinge-bottom {
            width: 60%;
            height: 20px;
            background: linear-gradient(135deg, var(--door-secondary), #F4C430);
            margin: 0 auto;
            border-radius: 10px;
            box-shadow: 
                var(--gold-glow), 
                0 5px 15px rgba(0, 0, 0, 0.7),
                inset 0 2px 5px rgba(255, 255, 255, 0.3);
            position: relative;
            z-index: 2;
            border: 2px solid var(--door-accent);
        }

        /* Additional Door Decorations */
        .door-knob {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            background: radial-gradient(circle, var(--door-secondary) 0%, #F4C430 100%);
            border-radius: 50%;
            box-shadow: var(--gold-glow), 0 5px 15px rgba(0, 0, 0, 0.7);
            z-index: 2;
            border: 3px solid var(--door-accent);
        }

        .left-door .door-knob {
            right: 30px;
        }

        .right-door .door-knob {
            left: 30px;
        }

        /* Carved Patterns on Doors */
        .door-pattern {
            position: absolute;
            width: 80%;
            height: 60%;
            top: 20%;
            left: 10%;
            background-image: 
                radial-gradient(circle at 30% 50%, rgba(212, 175, 55, 0.1) 2px, transparent 2px),
                radial-gradient(circle at 70% 50%, rgba(212, 175, 55, 0.1) 2px, transparent 2px);
            background-size: 50px 50px;
            z-index: 1;
            opacity: 0.6;
        }

        /* FIXED: Open Door Class */
        .left-door.open {
            transform: translateX(-100%) rotateY(-90deg);
        }

        .right-door.open {
            transform: translateX(100%) rotateY(90deg);
        }

        /* Enhanced Open Door Button */
        .open-door-btn {
            position: absolute;
            z-index: 10000;
            padding: 25px 50px;
            background: linear-gradient(135deg, var(--door-secondary), #F4C430);
            color: var(--door-accent);
            border: 4px solid var(--door-accent);
            border-radius: 60px;
            font-size: 1.8rem;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 
                0 0 35px rgba(212, 175, 55, 1), 
                0 10px 30px rgba(0, 0, 0, 0.7),
                inset 0 2px 10px rgba(255, 255, 255, 0.4);
            font-family: 'Playfair Display', serif;
            letter-spacing: 2px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        .open-door-btn.arabic {
            font-family: 'Amiri', serif;
        }

        .open-door-btn:hover {
            transform: scale(1.1) translateY(-5px);
            box-shadow: 
                0 0 50px rgba(212, 175, 55, 1), 
                0 15px 40px rgba(0, 0, 0, 0.8),
                inset 0 2px 10px rgba(255, 255, 255, 0.6);
            background: linear-gradient(135deg, #F4C430, var(--door-secondary));
        }
        
        .open-door-btn i {
            margin-right: 15px;
            animation: knockShake 2s infinite;
        }

        @keyframes knockShake {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(5px); }
        }
        
        /* Door Title/Text */
        .door-text {
            position: absolute;
            top: 10%;
            color: var(--door-secondary);
            font-size: 3.5rem;
            font-family: 'Dancing Script', cursive;
            text-shadow: 
                0 0 25px var(--door-secondary), 
                0 0 15px rgba(0, 0, 0, 0.8),
                2px 2px 4px rgba(0, 0, 0, 0.5);
            z-index: 10000;
            text-align: center;
            width: 100%;
            padding: 0 20px;
        }
        
        .door-text-arabic {
            position: absolute;
            top: 10%;
            color: var(--door-secondary);
            font-size: 3.5rem;
            font-family: 'Amiri', serif;
            text-shadow: 
                0 0 25px var(--door-secondary), 
                0 0 15px rgba(0, 0, 0, 0.8),
                2px 2px 4px rgba(0, 0, 0, 0.5);
            z-index: 10000;
            text-align: center;
            width: 100%;
            padding: 0 20px;
            display: none;
        }
        
        /* Scroll Prompt (Hidden until doors open) */
        .scroll-prompt {
            position: absolute;
            bottom: 40px;
            color: var(--door-secondary);
            font-size: 1.5rem;
            z-index: 10000;
            display: none;
            animation: bounce 2s infinite;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.8);
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-15px);
            }
            60% {
                transform: translateY(-7px);
            }
        }
        
        /* Ensure main content is initially hidden and fades in */
        .container, header, .location-section, #messages, footer {
            opacity: 0;
            transition: opacity 1.5s ease-in 1.5s;
        }
        
        .page-visible .container, 
        .page-visible header, 
        .page-visible .location-section, 
        .page-visible #messages, 
        .page-visible footer {
            opacity: 1;
        }

        /* Responsive */
        @media (min-width: 768px) {
            .couple-names {
                font-size: 5rem;
            }
            
            .couple-names.arabic {
                font-size: 4.5rem;
            }
            
            .wedding-date {
                font-size: 2rem;
            }
            
            .countdown {
                gap: 20px;
            }
            
            .countdown-item {
                min-width: 110px;
                padding: 20px;
            }
            
            .countdown-number {
                font-size: 2.8rem;
            }
            
            .countdown-label {
                font-size: 1rem;
            }
            
            .celebration-title {
                font-size: 4rem;
            }
            
            .celebration-title.arabic {
                font-size: 4.5rem;
            }
            
            .celebration-subtitle {
                font-size: 2rem;
            }
            
            .location-container {
                flex-direction: row;
                gap: 50px;
            }
            
            .location-content {
                width: auto;
            }
            
            .location-image {
                width: auto;
                height: 450px;
            }
            
            .btn {
                width: auto;
            }
            
            .music-text {
                display: inline;
            }
            
            /* Responsive adjustments for door text */
            .door-text, .door-text-arabic {
                font-size: 4rem;
                top: 10%;
            }
            .open-door-btn {
                padding: 25px 50px;
                font-size: 2rem;
            }
        }

        @media (max-width: 768px) {
            /* Responsive adjustments for door text */
            .door-text, .door-text-arabic {
                font-size: 2.5rem;
                top: 5%;
            }
            .open-door-btn {
                padding: 20px 40px;
                font-size: 1.5rem;
            }
            
            .hinge-top, .hinge-bottom {
                width: 80%;
            }
            
            .door-knob {
                width: 30px;
                height: 30px;
            }
            
            .celebration-title {
                font-size: 2.5rem;
            }
            
            .celebration-title.arabic {
                font-size: 2.8rem;
            }
            
            .celebration-subtitle {
                font-size: 1.3rem;
            }
        }
        
        @media (max-width: 480px) {
            .couple-names {
                font-size: 2rem;
            }
            
            .couple-names.arabic {
                font-size: 2.2rem;
            }
            
            .countdown {
                flex-wrap: wrap;
            }
            
            .countdown-item {
                min-width: 65px;
                padding: 10px;
            }
            
            .countdown-number {
                font-size: 1.5rem;
            }
            
            .celebration-title {
                font-size: 2rem;
            }
            
            .celebration-title.arabic {
                font-size: 2.2rem;
            }
            
            .celebration-subtitle {
                font-size: 1.1rem;
            }
            
            .music-text {
                display: none;
            }
            
            .door-text, .door-text-arabic {
                font-size: 2rem;
                top: 8%;
            }
            
            .open-door-btn {
                padding: 15px 30px;
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <div id="door-overlay">
        <div class="door-text" id="door-title">Welcome to Our Magical Wedding</div>
        <div class="door-text-arabic" id="door-title-arabic">مرحباً بكم في حفل زفافنا السحري</div>
        <div class="left-door" id="left-door">
            <div class="hinge-top"></div>
            <div class="door-pattern"></div>
            <div class="door-knob"></div>
            <div class="hinge-bottom"></div>
        </div>
        <div class="right-door" id="right-door">
            <div class="hinge-top"></div>
            <div class="door-pattern"></div>
            <div class="door-knob"></div>
            <div class="hinge-bottom"></div>
        </div>
        <button class="open-door-btn" id="openDoorBtn">
            <i class="fas fa-hand-pointer"></i> <span id="openDoorText">Knock The Door</span>
        </button>
        <div class="scroll-prompt" id="scrollPrompt">
            <i class="fas fa-chevron-down"></i> <span id="scrollText">Scroll Down</span>
        </div>
    </div>
    <div class="language-switcher">
        <button class="lang-btn active" id="langEn">EN</button>
        <button class="lang-btn" id="langAr">ع</button>
    </div>

    <div class="music-player" id="musicPlayer">
        <button class="music-toggle" id="musicToggle">
            <i class="fas fa-volume-up"></i>
        </button>
    </div>

    <div class="floating-hearts" id="hearts-container"></div>
    <div class="floating-hearts" id="flowers-container"></div>
    <div class="celebration-hearts" id="celebration-hearts"></div>

    <div class="container">
        <header>
            <div class="magic-particles" id="particles-container"></div>
            <h1 class="couple-names" id="coupleNames">Khalid & Salma</h1>
            <p class="wedding-date" id="weddingDate">12th December, 2025</p>
            
            <div class="countdown" id="countdown">
                <div class="countdown-item">
                    <span class="countdown-number" id="days">00</span>
                    <span class="countdown-label" id="daysLabel">Days</span>
                </div>
                <div class="countdown-item">
                    <span class="countdown-number" id="hours">00</span>
                    <span class="countdown-label" id="hoursLabel">Hours</span>
                </div>
                <div class="countdown-item">
                    <span class="countdown-number" id="minutes">00</span>
                    <span class="countdown-label" id="minutesLabel">Minutes</span>
                </div>
                <div class="countdown-item">
                    <span class="countdown-number" id="seconds">00</span>
                    <span class="countdown-label" id="secondsLabel">Seconds</span>
                </div>
            </div>
            
            <!-- WEDDING DAY CELEBRATION CONTAINER -->
            <div class="wedding-celebration" id="weddingCelebration">
                <div class="celebration-container" id="celebrationContainer">
                    <h2 class="celebration-title" id="celebrationTitle">The Wedding Has Begun! 🎉</h2>
                    <p class="celebration-subtitle" id="celebrationSubtitle">Let the celebration commence!</p>
                </div>
            </div>
            
            <p class="invitation-text" id="invitationText">With immense joy and love, we invite you to witness and celebrate our union as we begin our journey together as husband and wife.</p>
        </header>

        <section class="location-section">
            <div class="location-container">
                <div class="location-content">
                    <h2 class="location-title" id="locationTitle">Our Wedding Celebration</h2>
                    <div class="magic-card">
                        <div class="event-icon">
                            <i class="fas fa-ring"></i>
                        </div>
                        <h3 class="event-title" id="ceremonyTitle">Wedding Ceremony</h3>
                        <div class="event-details" id="eventDetails">
                            <p><strong id="dateLabel">Date:</strong> December 12, 2025</p>
                            <p><strong id="timeLabel">Time:</strong> 7:30 PM</p>
                            <p><strong id="locationLabel">Location:</strong> Cleopatra Royal Hall</p>
                            <p>Dekernes</p>
                        </div>
                        <a href="https://www.google.com/maps/place/%D9%82%D8%A7%D8%B9%D8%A9+%D9%83%D9%84%D9%8A%D9%88%D8%A8%D8%A7%D8%AA%D8%B1%D8%A7+%D9%84%D9%84%D9%85%D9%86%D8%A7%D8%B3%D8%A8%D8%A7%D8%AA%E2%80%AD/@31.091408,31.583609,16z/data=!4m6!3m5!1s0x14f77e7d76e8d1b5:0x89499f8d1fa8bee6!8m2!3d31.0914082!4d31.5836093!16s%2Fg%2F11c59zqt8b?hl=ar&entry=ttu&g_ep=EgoyMDI1MTIwNy4wIKXMDSoASAFQAw%3D%3D" target="_blank" class="location-link">
                            <i class="fas fa-map-marker-alt"></i> <span id="mapText">View on Google Maps</span>
                        </a>
                    </div>
                </div>
                <div class="location-image"></div>
            </div>
        </section>

        <section class="magic-message-gallery" id="magicMessageGallery">
            <div class="magic-glow"></div>
            <h2 class="magic-message-title" id="magicMessageGalleryTitle">Messages from Our Loved Ones</h2>
            <div class="magic-message-container" id="magicMessageContainer">
                <!-- Messages will be loaded here -->
            </div>
        </section>

        <section id="messages">
            <h2 class="section-title" id="wishesTitle">Send Your Wishes</h2>
            <p style="text-align: center; margin-bottom: 20px;" id="wishesSubtitle">Share your congratulations and message for our special day</p>
            
            <div class="success-message" id="successMessage"></div>
            <div class="error-message" id="errorMessage"></div>
            <div class="limit-message" id="limitMessage"></div>
            
            <form class="message-form" id="messageForm">
                <div class="form-group" id="nameGroup">
                    <label for="name" id="nameLabel">Full Name</label>
                    <input type="text" id="name" class="form-control" placeholder="Enter your full name" required>
                </div>
                <div class="form-group" id="messageGroup">
                    <label for="message" id="messageLabel">Your Message</label>
                    <textarea id="message" class="form-control" rows="4" placeholder="Write your congratulations message here..." required></textarea>
                </div>
                <button type="submit" class="btn" id="submitBtn">
                    <span id="submitText">Send Message</span>
                    <span id="loadingText" style="display: none;">
                        <i class="fas fa-spinner fa-spin"></i> Sending...
                    </span>
                </button>
            </form>
        </section>

        <footer>
            <p class="footer-text" id="footerLove">With love, Khalid & Salma</p>
            <p id="footerCopyright">© 2025 | Made with ❤️ for our special day</p>
        </footer>
    </div>

    <audio id="backgroundMusic" loop>
        <source src="wedding-music-1.mp3" type="audio/mpeg">
        <source src="wedding-music-2.mp3" type="audio/mpeg">
        <source src="wedding-music-3.mp3" type="audio/mpeg">
        <source src="wedding-music-4.mp3" type="audio/mpeg">
    </audio>

    <script>
        // Language Content
        const content = {
            en: {
                // NEW DOOR TEXT
                doorTitle: "Welcome to Our Magical Wedding",
                openDoorText: "Knock The Door",
                scrollText: "Scroll Down",
                // END NEW DOOR TEXT
                coupleNames: "Khalid & Salma",
                weddingDate: "12th December, 2025",
                daysLabel: "Days",
                hoursLabel: "Hours", 
                minutesLabel: "Minutes",
                secondsLabel: "Seconds",
                invitationText: "With immense joy and love, we invite you to witness and celebrate our union as we begin our journey together as husband and wife.",
                locationTitle: "Our Wedding Celebration",
                ceremonyTitle: "Wedding Ceremony",
                dateLabel: "Date:",
                timeLabel: "Time:",
                locationLabel: "Location:",
                eventDetails: "<p><strong>Date:</strong> December 12, 2025</p><p><strong>Time:</strong> 7:00 PM</p><p><strong>Location:</strong> Celpoatra Royal Hall</p><p>Dekernes</p>",
                mapText: "View on Google Maps",
                wishesTitle: "Send Your Wishes",
                wishesSubtitle: "Share your congratulations and message for our special day",
                nameLabel: "Full Name",
                namePlaceholder: "Enter your full name",
                messageLabel: "Your Message",
                messagePlaceholder: "Write your congratulations message here...",
                submitBtn: "Send Message",
                footerLove: "With love, Khalid & Salma",
                footerCopyright: "© 2025 | Made with ❤️ for our special day",
                clickToPlay: "Click to play music",
                successMessage: "Thank you! Your message has been saved successfully!",
                errorMessage: "Sorry, there was an error sending your message. Please try again.",
                viewMessagesText: "View Messages",
                magicMessageGalleryTitle: "Messages from Our Loved Ones",
                noMessagesText: "No messages yet. Be the first to send your wishes!",
                // NEW CELEBRATION TEXT
                celebrationTitle: "The Wedding Has Begun! 🎉",
                celebrationSubtitle: "Let the celebration commence!",
            },
            ar: {
                // NEW DOOR TEXT
                doorTitle: "مرحباً بكم في حفل زفافنا السحري",
                openDoorText: "انقر للدخول",
                scrollText: "مرر للأسفل",
                // END NEW DOOR TEXT
                coupleNames: "خالد و سلمي",
                weddingDate: "١٢ ديسمبر ٢٠٢٥",
                daysLabel: "أيام",
                hoursLabel: "ساعات",
                minutesLabel: "دقائق", 
                secondsLabel: "ثواني",
                invitationText: "بكل فرح وحب، ندعوكم لمشاركتنا فرحة زفافنا والاحتفال ببداية رحلتنا معًا كزوج وزوجة.",
                locationTitle: "احتفال زفافنا",
                ceremonyTitle: "حفل الزفاف",
                dateLabel: "التاريخ:",
                timeLabel: "الوقت:",
                locationLabel: "المكان:",
                eventDetails: "<p><strong>التاريخ:</strong> ١٢ ديسمبر ٢٠٢٥</p><p><strong>الوقت:</strong>٧:٣٠ مساءً</p><p><strong>المكان:</strong> قاعة كليوباترالملكية</p><p>دكرنس</p>",
                mapText: "عرض على خرائط جوجل",
                wishesTitle: "أرسل تهنئتك",
                wishesSubtitle: "شاركنا تهنئتك ورسالتك في يومنا السعيد",
                nameLabel: "الاسم الكامل",
                namePlaceholder: "أدخل اسمك الكامل",
                messageLabel: "رسالتك",
                messagePlaceholder: "اكتب رسالة التهنئة هنا...",
                submitBtn: "إرسال الرسالة",
                footerLove: "بكل حب، خالد و سلمي",
                footerCopyright: "© ٢٠٢٥ | صنع من أجل يومنا الخاص ❤️",
                successMessage: "شكراً لك! تم حفظ رسالتك بنجاح!",
                errorMessage: "عذراً، حدث خطأ في إرسال رسالتك. يرجى المحاولة مرة أخرى.",
                viewMessagesText: "عرض الرسائل",
                magicMessageGalleryTitle: "رسائل من أحبائنا",
                noMessagesText: "لا توجد رسائل حتى الآن. كن أول من يرسل تهنئته!",
                // NEW CELEBRATION TEXT
                celebrationTitle: "لقد بدأ الحفل! 🎉",
                celebrationSubtitle: "لنبدأ الاحتفال!",
            }
        };

        let currentLang = 'en';
        let userMessageCount = 0;

        // Generate or retrieve unique user ID
        function getUserId() {
            let userId = localStorage.getItem('weddingUserId');
            if (!userId) {
                userId = 'user_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('weddingUserId', userId);
            }
            return userId;
        }

        // Check user's message count
        async function checkUserMessageCount() {
            try {
                const userId = getUserId();
                const { collection, getDocs, query, where } = window.firebaseModules;
                
                const messagesQuery = query(
                    collection(window.firestore, 'weddingMessages2'), 
                    where('userId', '==', userId)
                );
                
                const querySnapshot = await getDocs(messagesQuery);
                userMessageCount = querySnapshot.size;
                
                console.log(`User has submitted ${userMessageCount} messages`);
                
                // Update UI based on message count
                updateMessageLimitUI();
                
                return userMessageCount;
            } catch (error) {
                console.error("Error checking user message count: " + error);
                return 0;
            }
        }

        // Update UI based on message count
        function updateMessageLimitUI() {
            const submitBtn = document.getElementById('submitBtn');
            const wishesSubtitle = document.getElementById('wishesSubtitle');
            
            if (userMessageCount >= 2) {
                // User has reached the limit
                submitBtn.disabled = true;
                submitBtn.style.opacity = '0.6';
                if (wishesSubtitle) {
                    wishesSubtitle.textContent = currentLang === 'en' ? 
                        "You've reached the maximum number of messages (2)" :
                        "لقد وصلت إلى الحد الأقصى لعدد الرسائل (2)";
                }
            } else {
                // User can still submit messages
                submitBtn.disabled = false;
                submitBtn.style.opacity = '1';
                
                // Update subtitle to show remaining messages
                const remaining = 2 - userMessageCount;
                if (wishesSubtitle) {
                    wishesSubtitle.textContent = currentLang === 'en' ? 
                        `Share your congratulations and message for our special day (${remaining} remaining)` :
                        `شاركنا تهنئتك ورسالتك في يومنا السعيد (متبقي ${remaining})`;
                }
            }
        }

        // Initialize audio
        function initAudio() {
            const backgroundMusic = document.getElementById('backgroundMusic');
            backgroundMusic.volume = 0.7;
            console.log("Audio initialized");
        }

        // Firebase Message Storage
        async function saveMessageToFirebase(name, message) {
            try {
                const { collection, addDoc, serverTimestamp } = window.firebaseModules;
                
                const messageData = {
                    name: name,
                    message: message,
                    timestamp: serverTimestamp(),
                    language: currentLang,
                    wedding: 'khalid-salma',
                    flagged: true, // Always flag messages to show them
                    userId: getUserId()
                };

                const docRef = await addDoc(collection(window.firestore, 'weddingMessages2'), messageData);
                console.log("Message saved with ID: " + docRef.id);
                
                // Update local message count
                userMessageCount++;
                updateMessageLimitUI();
                
                return true;
            } catch (error) {
                console.error("Error saving message: " + error);
                return false;
            }
        }

        // Load ALL messages for the magical gallery (not just flagged)
        async function loadAllMessages() {
            try {
                console.log("Loading all messages for magical gallery...");
                
                const { collection, getDocs, query, orderBy } = window.firebaseModules;
                
                const messagesQuery = query(
                    collection(window.firestore, 'weddingMessages2'),
                    orderBy('timestamp', 'desc')
                );
                const querySnapshot = await getDocs(messagesQuery);
                const magicMessageContainer = document.getElementById('magicMessageContainer');
                magicMessageContainer.innerHTML = '';
                
                const allMessages = [];
                querySnapshot.forEach((doc) => {
                    const messageData = doc.data();
                    if (messageData.wedding === 'khalid-salma') {
                        allMessages.push({ id: doc.id, ...messageData });
                    }
                });
                
                console.log("All messages found: " + allMessages.length);
                
                if (allMessages.length === 0) {
                    const noMessages = document.createElement('div');
                    noMessages.className = `no-messages ${currentLang === 'ar' ? 'arabic' : ''}`;
                    noMessages.textContent = content[currentLang].noMessagesText;
                    magicMessageContainer.appendChild(noMessages);
                    return true;
                }
                
                let messageIndex = 0;
                allMessages.forEach((messageData) => {
                    console.log("Message data: " + JSON.stringify(messageData));
                    
                    const messageBox = createMagicMessageBox(messageData, messageIndex);
                    magicMessageContainer.appendChild(messageBox);
                    messageIndex++;
                });
                
                console.log("Displayed " + messageIndex + " messages in magical gallery");
                
                return true;
            } catch (error) {
                console.error("Error loading messages: " + error);
                const magicMessageContainer = document.getElementById('magicMessageContainer');
                if (magicMessageContainer) {
                    magicMessageContainer.innerHTML = `
                        <div class="no-messages ${currentLang === 'ar' ? 'arabic' : ''}">
                            ${currentLang === 'en' ? 'Error loading messages. Please try again later.' : 'خطأ في تحميل الرسائل. يرجى المحاولة مرة أخرى لاحقاً.'}
                        </div>
                    `;
                }
                return false;
            }
        }

        // Create a magical message box element
        function createMagicMessageBox(messageData, index) {
            const messageBox = document.createElement('div');
            messageBox.className = 'magic-message-box';
            messageBox.style.animationDelay = `${index * 0.1}s`;
            
            const star = document.createElement('div');
            star.className = 'magic-message-star';
            star.innerHTML = '<i class="fas fa-star"></i>';
            
            const author = document.createElement('div');
            author.className = `magic-message-author ${messageData.language === 'ar' ? 'arabic' : ''}`;
            author.innerHTML = `<i class="fas fa-user"></i> ${messageData.name}`;
            
            const content = document.createElement('div');
            content.className = `magic-message-content ${messageData.language === 'ar' ? 'arabic' : ''}`;
            content.textContent = messageData.message;
            
            const date = document.createElement('div');
            date.className = `magic-message-date ${messageData.language === 'ar' ? 'arabic' : ''}`;
            
            // Format the date
            if (messageData.timestamp && messageData.timestamp.toDate) {
                try {
                    const messageDate = messageData.timestamp.toDate();
                    date.textContent = messageDate.toLocaleDateString(currentLang === 'ar' ? 'ar-EG' : 'en-US', {
                        year: 'numeric',
                        month: 'short',
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                } catch (error) {
                    date.textContent = 'Recently';
                }
            } else {
                date.textContent = 'Recently';
            }
            
            messageBox.appendChild(star);
            messageBox.appendChild(author);
            messageBox.appendChild(content);
            messageBox.appendChild(date);
            
            return messageBox;
        }

        // MAGICAL COUNTDOWN COMPLETION FUNCTION
        function createWeddingCelebration() {
            const countdown = document.getElementById('countdown');
            const weddingCelebration = document.getElementById('weddingCelebration');
            const celebrationContainer = document.getElementById('celebrationContainer');
            const celebrationTitle = document.getElementById('celebrationTitle');
            const celebrationSubtitle = document.getElementById('celebrationSubtitle');
            
            if (!countdown || !weddingCelebration) return;
            
            // 1. Add explosion animation to countdown
            countdown.classList.add('completed');
            
            // 2. Create explosion particles
            createCountdownExplosion();
            
            // 3. Show celebration after explosion animation completes
            setTimeout(() => {
                // Hide countdown completely
                countdown.style.display = 'none';
                
                // Update celebration text based on language
                celebrationTitle.textContent = content[currentLang].celebrationTitle;
                celebrationSubtitle.textContent = content[currentLang].celebrationSubtitle;
                
                // Add language class if Arabic
                if (currentLang === 'ar') {
                    celebrationTitle.classList.add('arabic');
                    celebrationSubtitle.classList.add('arabic');
                } else {
                    celebrationTitle.classList.remove('arabic');
                    celebrationSubtitle.classList.remove('arabic');
                }
                
                // Show celebration container
                weddingCelebration.style.display = 'block';
                
                // Create magical celebration elements
                createCelebrationElements();
                
                // Play celebration sound if possible
                playCelebrationSound();
                
            }, 1500);
        }
        
        // Create explosion particles when countdown reaches zero
        function createCountdownExplosion() {
            const countdown = document.getElementById('countdown');
            if (!countdown) return;
            
            const rect = countdown.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            // Create 50 explosion particles
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'celebration-sparkle';
                particle.style.position = 'fixed';
                particle.style.left = centerX + 'px';
                particle.style.top = centerY + 'px';
                particle.style.zIndex = '1000';
                
                // Randomize particle properties
                const size = Math.random() * 10 + 5;
                particle.style.width = size + 'px';
                particle.style.height = size + 'px';
                particle.style.background = getRandomColor();
                particle.style.borderRadius = '50%';
                particle.style.boxShadow = `0 0 15px ${particle.style.background}`;
                
                // Random animation
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 200 + 100;
                const distance = Math.random() * 300 + 100;
                const duration = Math.random() * 1 + 0.5;
                
                particle.style.animation = `sparklePop ${duration}s ease-out forwards`;
                
                // Apply movement
                setTimeout(() => {
                    const endX = centerX + Math.cos(angle) * distance;
                    const endY = centerY + Math.sin(angle) * distance;
                    
                    particle.style.transition = `all ${duration}s ease-out`;
                    particle.style.left = endX + 'px';
                    particle.style.top = endY + 'px';
                    particle.style.opacity = '0';
                }, 10);
                
                document.body.appendChild(particle);
                
                // Remove particle after animation
                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.parentNode.removeChild(particle);
                    }
                }, duration * 1000 + 100);
            }
            
            // Create 20 ring elements
            for (let i = 0; i < 20; i++) {
                const ring = document.createElement('div');
                ring.className = 'celebration-ring';
                ring.style.position = 'fixed';
                ring.style.left = centerX + 'px';
                ring.style.top = centerY + 'px';
                ring.style.zIndex = '1000';
                ring.style.animationDelay = Math.random() * 0.5 + 's';
                
                document.body.appendChild(ring);
                
                // Remove ring after animation
                setTimeout(() => {
                    if (ring.parentNode) {
                        ring.parentNode.removeChild(ring);
                    }
                }, 4000);
            }
        }
        
        // Get random celebration color
        function getRandomColor() {
            const colors = [
                '#D4AF37', // gold
                '#C19A6B', // brown
                '#8B4513', // saddle brown
                '#F5EBDC', // cream
                '#FFFFFF', // white
                '#5D4037', // dark brown
            ];
            return colors[Math.floor(Math.random() * colors.length)];
        }
        
        // Create magical celebration elements
        function createCelebrationElements() {
            const celebrationContainer = document.getElementById('celebrationContainer');
            if (!celebrationContainer) return;
            
            // Create floating hearts
            for (let i = 0; i < 15; i++) {
                const heart = document.createElement('div');
                heart.className = 'celebration-heart';
                heart.innerHTML = '❤';
                heart.style.left = Math.random() * 100 + '%';
                heart.style.animationDelay = Math.random() * 2 + 's';
                heart.style.fontSize = (Math.random() * 30 + 20) + 'px';
                heart.style.color = getRandomColor();
                
                celebrationContainer.appendChild(heart);
            }
            
            // Create sparkling stars
            for (let i = 0; i < 30; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'celebration-sparkle';
                sparkle.style.left = Math.random() * 100 + '%';
                sparkle.style.top = Math.random() * 100 + '%';
                sparkle.style.animationDelay = Math.random() * 2 + 's';
                sparkle.style.background = getRandomColor();
                
                celebrationContainer.appendChild(sparkle);
            }
            
            // Create floating rings
            for (let i = 0; i < 8; i++) {
                const ring = document.createElement('div');
                ring.className = 'celebration-ring';
                ring.style.left = Math.random() * 100 + '%';
                ring.style.top = Math.random() * 100 + '%';
                ring.style.animationDelay = Math.random() * 2 + 's';
                ring.style.borderColor = getRandomColor();
                ring.style.boxShadow = `0 0 30px ${getRandomColor()}`;
                
                celebrationContainer.appendChild(ring);
            }
            
            // Create firework effect
            createFireworks();
        }
        
        // Create fireworks effect
        function createFireworks() {
            const container = document.getElementById('weddingCelebration');
            if (!container) return;
            
            // Create 5 fireworks
            for (let f = 0; f < 5; f++) {
                setTimeout(() => {
                    const centerX = Math.random() * 80 + 10;
                    const centerY = Math.random() * 50 + 25;
                    
                    // Create 30 particles per firework
                    for (let i = 0; i < 30; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'celebration-firework';
                        particle.style.position = 'absolute';
                        particle.style.left = centerX + '%';
                        particle.style.top = centerY + '%';
                        particle.style.background = getRandomColor();
                        
                        const angle = Math.random() * Math.PI * 2;
                        const distance = Math.random() * 100 + 50;
                        const duration = Math.random() * 1 + 0.5;
                        
                        particle.style.animation = `sparklePop ${duration}s ease-out forwards`;
                        
                        container.appendChild(particle);
                        
                        // Apply movement
                        setTimeout(() => {
                            const endX = centerX + Math.cos(angle) * distance / 10;
                            const endY = centerY + Math.sin(angle) * distance / 10;
                            
                            particle.style.transition = `all ${duration}s ease-out`;
                            particle.style.left = endX + '%';
                            particle.style.top = endY + '%';
                            particle.style.opacity = '0';
                        }, 10);
                        
                        // Remove after animation
                        setTimeout(() => {
                            if (particle.parentNode) {
                                particle.parentNode.removeChild(particle);
                            }
                        }, duration * 1000 + 100);
                    }
                }, f * 500);
            }
        }
        
        // Play celebration sound
        function playCelebrationSound() {
            console.log("Wedding celebration sound would play here!");
        }

        // Form submission with Firebase
        document.getElementById('messageForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const name = document.getElementById('name').value.trim();
            const message = document.getElementById('message').value.trim();
            const submitBtn = document.getElementById('submitBtn');
            const submitText = document.getElementById('submitText');
            const loadingText = document.getElementById('loadingText');
            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');
            const limitMessage = document.getElementById('limitMessage');

            // Hide previous messages
            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';
            limitMessage.style.display = 'none';

            // Show loading state
            submitBtn.disabled = true;
            submitText.style.display = 'none';
            loadingText.style.display = 'inline';

            try {
                // Wait for Firebase to be ready
                if (!window.firestore) {
                    throw new Error('Firebase not initialized yet');
                }

                // Save to Firebase
                const saved = await saveMessageToFirebase(name, message);
                
                if (saved) {
                    // Show success message
                    successMessage.textContent = content[currentLang].successMessage;
                    successMessage.style.display = 'block';
                    
                    // Create celebration heart animation
                    createCelebrationHearts();
                    
                    // Reload messages to show the new one
                    await loadAllMessages();
                    
                    // Reset form
                    this.reset();
                } else {
                    throw new Error('Failed to save message');
                }
            } catch (error) {
                // Show error message
                errorMessage.textContent = content[currentLang].errorMessage;
                errorMessage.style.display = 'block';
                console.error('Form submission error: ' + error);
            } finally {
                // Reset button state (unless user reached limit)
                if (userMessageCount < 2) {
                    submitBtn.disabled = false;
                }
                submitText.style.display = 'inline';
                loadingText.style.display = 'none';
            }
        });

        // Create celebration hearts when form is submitted
        function createCelebrationHearts() {
            const celebrationContainer = document.getElementById('celebration-hearts');
            celebrationContainer.innerHTML = '';
            
            // Create multiple hearts (15-20)
            const heartCount = 15 + Math.floor(Math.random() * 6);
            
            for (let i = 0; i < heartCount; i++) {
                const heart = document.createElement('div');
                heart.classList.add('celebration-heart');
                heart.innerHTML = '❤';
                
                // Randomize position and animation
                const startX = Math.random() * window.innerWidth;
                const startY = window.innerHeight + 20;
                const duration = 2 + Math.random() * 2;
                const delay = Math.random() * 0.5;
                
                heart.style.left = startX + 'px';
                heart.style.top = startY + 'px';
                heart.style.animationDuration = duration + 's';
                heart.style.animationDelay = delay + 's';
                heart.style.color = `rgba(193, 154, 107, ${0.6 + Math.random() * 0.4})`;
                heart.style.fontSize = (20 + Math.random() * 20) + 'px';
                
                celebrationContainer.appendChild(heart);
                
                // Remove heart after animation completes
                setTimeout(() => {
                    if (heart.parentNode) {
                        heart.parentNode.removeChild(heart);
                    }
                }, (duration + delay) * 1000);
            }
        }
        
        // Door Animation Functionality - FIXED
        document.getElementById('openDoorBtn').addEventListener('click', async function() {
            const leftDoor = document.getElementById('left-door');
            const rightDoor = document.getElementById('right-door');
            const doorOverlay = document.getElementById('door-overlay');
            const openDoorBtn = document.getElementById('openDoorBtn');
            const doorTitle = document.getElementById('door-title');
            const doorTitleArabic = document.getElementById('door-title-arabic');
            const scrollPrompt = document.getElementById('scrollPrompt');
            
            // 1. Open the doors
            leftDoor.classList.add('open');
            rightDoor.classList.add('open');
            
            // 2. Hide button and titles
            openDoorBtn.style.display = 'none';
            if (doorTitle) doorTitle.style.display = 'none';
            if (doorTitleArabic) doorTitleArabic.style.display = 'none';

            // 3. Make the rest of the page visible (fade in)
            document.body.classList.add('page-visible');
            
            // 4. Show scroll prompt and fade out the overlay
            setTimeout(() => {
                if (scrollPrompt) scrollPrompt.style.display = 'block';
                
                // Fade out the overlay completely
                doorOverlay.style.opacity = '0';
            }, 1000);
            
            // 5. Remove overlay element completely after fade out
            setTimeout(() => {
                if (doorOverlay) doorOverlay.style.display = 'none';
                
                // Show the message gallery after doors open
                const magicMessageGallery = document.getElementById('magicMessageGallery');
                if (magicMessageGallery) {
                    magicMessageGallery.style.display = 'block';
                    magicMessageGallery.classList.add('active');
                    
                    // Load messages from Firebase
                    loadAllMessages();
                }
            }, 2500);
            
            // Try to start music after interaction
            const backgroundMusic = document.getElementById('backgroundMusic');
            if (backgroundMusic && backgroundMusic.paused) {
                startMusicOnInteraction();
            }
        });

        // Function to update door text based on language
        function updateDoorText(lang) {
            const doorTitleEn = document.getElementById('door-title');
            const doorTitleAr = document.getElementById('door-title-arabic');
            const openDoorTextSpan = document.getElementById('openDoorText');
            const scrollTextSpan = document.getElementById('scrollText');
            
            if (doorTitleEn) doorTitleEn.textContent = content[lang].doorTitle;
            if (doorTitleAr) doorTitleAr.textContent = content[lang].doorTitle;
            if (openDoorTextSpan) openDoorTextSpan.textContent = content[lang].openDoorText;
            if (scrollTextSpan) scrollTextSpan.textContent = content[lang].scrollText;
            
            if (lang === 'ar') {
                if (doorTitleEn) doorTitleEn.style.display = 'none';
                if (doorTitleAr) doorTitleAr.style.display = 'block';
            } else {
                if (doorTitleEn) doorTitleEn.style.display = 'block';
                if (doorTitleAr) doorTitleAr.style.display = 'none';
            }
        }


        // Language Switching - FIXED VERSION
        function switchLanguage(lang) {
            currentLang = lang;
            
            // Helper function to safely update element text
            function updateElementText(id, text) {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = text;
                }
            }
            
            // Helper function to safely update element innerHTML
            function updateElementHTML(id, html) {
                const element = document.getElementById(id);
                if (element) {
                    element.innerHTML = html;
                }
            }
            
            // Helper function to safely update element placeholder
            function updateElementPlaceholder(id, placeholder) {
                const element = document.getElementById(id);
                if (element) {
                    element.placeholder = placeholder;
                }
            }
            
            // Update all text content safely
            updateElementText('coupleNames', content[lang].coupleNames);
            updateElementText('weddingDate', content[lang].weddingDate);
            updateElementText('daysLabel', content[lang].daysLabel);
            updateElementText('hoursLabel', content[lang].hoursLabel);
            updateElementText('minutesLabel', content[lang].minutesLabel);
            updateElementText('secondsLabel', content[lang].secondsLabel);
            updateElementText('invitationText', content[lang].invitationText);
            updateElementText('locationTitle', content[lang].locationTitle);
            updateElementText('ceremonyTitle', content[lang].ceremonyTitle);
            updateElementHTML('eventDetails', content[lang].eventDetails);
            updateElementText('mapText', content[lang].mapText);
            updateElementText('wishesTitle', content[lang].wishesTitle);
            updateElementText('nameLabel', content[lang].nameLabel);
            updateElementPlaceholder('name', content[lang].namePlaceholder);
            updateElementText('messageLabel', content[lang].messageLabel);
            updateElementPlaceholder('message', content[lang].messagePlaceholder);
            updateElementText('submitText', content[lang].submitBtn);
            updateElementText('footerLove', content[lang].footerLove);
            updateElementText('footerCopyright', content[lang].footerCopyright);
            updateElementText('magicMessageGalleryTitle', content[lang].magicMessageGalleryTitle);
            // Update celebration text
            updateElementText('celebrationTitle', content[lang].celebrationTitle);
            updateElementText('celebrationSubtitle', content[lang].celebrationSubtitle);

            // Update language buttons
            const langEn = document.getElementById('langEn');
            const langAr = document.getElementById('langAr');
            if (langEn) langEn.classList.toggle('active', lang === 'en');
            if (langAr) langAr.classList.toggle('active', lang === 'ar');

            // Update RTL/LTR and font classes
            updateTextDirection(lang);
            
            // NEW: Update door text
            updateDoorText(lang);
            
            // Update message limit UI
            updateMessageLimitUI();
            
            // Reload messages with new language
            loadAllMessages();
        }

        function updateTextDirection(lang) {
            const elementsToUpdate = [
                'coupleNames', 'weddingDate', 'invitationText', 'locationTitle', 
                'ceremonyTitle', 'eventDetails', 'wishesTitle', 'wishesSubtitle',
                'nameGroup', 'messageGroup', 'footerLove', 'footerCopyright',
                'magicMessageGalleryTitle', 'celebrationTitle', 'celebrationSubtitle'
            ];

            elementsToUpdate.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.classList.toggle('arabic', lang === 'ar');
                    if (lang === 'ar') {
                        element.style.direction = 'rtl';
                        element.style.textAlign = 'center';
                    } else {
                        element.style.direction = 'ltr';
                        element.style.textAlign = 'center';
                    }
                }
            });

            // Update form controls
            const nameInput = document.getElementById('name');
            const messageInput = document.getElementById('message');
            const submitBtn = document.getElementById('submitBtn');

            if (nameInput && messageInput && submitBtn) {
                if (lang === 'ar') {
                    nameInput.classList.add('arabic');
                    messageInput.classList.add('arabic');
                    submitBtn.classList.add('arabic');
                    nameInput.style.textAlign = 'right';
                    messageInput.style.textAlign = 'right';
                } else {
                    nameInput.classList.remove('arabic');
                    messageInput.classList.remove('arabic');
                    submitBtn.classList.remove('arabic');
                    nameInput.style.textAlign = 'left';
                    messageInput.style.textAlign = 'left';
                }
            }
            
            // NEW: Door button styling for RTL
            const openDoorBtn = document.getElementById('openDoorBtn');
            if (openDoorBtn) {
                openDoorBtn.classList.toggle('arabic', lang === 'ar');
                openDoorBtn.style.fontFamily = lang === 'ar' ? 'Amiri, serif' : 'Playfair Display, serif';
            }
        }

        // Event listeners for language buttons
        document.getElementById('langEn').addEventListener('click', () => switchLanguage('en'));
        document.getElementById('langAr').addEventListener('click', () => switchLanguage('ar'));

        // Music Player Functionality
        const musicToggle = document.getElementById('musicToggle');
        const musicPlayer = document.getElementById('musicPlayer');
        const backgroundMusic = document.getElementById('backgroundMusic');
        let isPlaying = false;

        // Initialize audio when page loads
        window.addEventListener('load', async function() {
            console.log("Page loaded, initializing...");
            
            // Initialize audio
            initAudio();
            
            // Check user's message count on page load
            console.log("Checking user message count on page load...");
            await checkUserMessageCount();
        });

        function startMusicOnInteraction() {
            backgroundMusic.play().then(() => {
                isPlaying = true;
                if (musicToggle) musicToggle.innerHTML = '<i class="fas fa-volume-up"></i>';
                if (musicPlayer) musicPlayer.classList.add('playing');
                console.log("Music started successfully");
            }).catch(error => {
                console.log("Music play failed: " + error);
            });
        }

        // Music toggle functionality
        if (musicToggle) {
            musicToggle.addEventListener('click', function() {
                if (isPlaying) {
                    backgroundMusic.pause();
                    musicToggle.innerHTML = '<i class="fas fa-volume-mute"></i>';
                    musicPlayer.classList.remove('playing');
                    isPlaying = false;
                } else {
                    backgroundMusic.play().then(() => {
                        musicToggle.innerHTML = '<i class="fas fa-volume-up"></i>';
                        musicPlayer.classList.add('playing');
                        isPlaying = true;
                    }).catch(error => {
                        console.log("Music play failed: " + error);
                    });
                }
            });
        }

        // Countdown Timer for December 12, 2025
        function updateCountdown() {
            const weddingDate = new Date('December 12, 2025 16:00:00').getTime();
            const now = new Date().getTime();
            const timeLeft = weddingDate - now;
            
            const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
            const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            
            const daysEl = document.getElementById('days');
            const hoursEl = document.getElementById('hours');
            const minutesEl = document.getElementById('minutes');
            const secondsEl = document.getElementById('seconds');
            
            if (daysEl) daysEl.innerHTML = days < 10 ? '0' + days : days;
            if (hoursEl) hoursEl.innerHTML = hours < 10 ? '0' + hours : hours;
            if (minutesEl) minutesEl.innerHTML = minutes < 10 ? '0' + minutes : minutes;
            if (secondsEl) secondsEl.innerHTML = seconds < 10 ? '0' + seconds : seconds;
            
            if (timeLeft < 0) {
                clearInterval(countdownTimer);
                // Create magical celebration
                createWeddingCelebration();
            }
        }
        
        const countdownTimer = setInterval(updateCountdown, 1000);
        updateCountdown();
        
        // Create floating particles
        const particlesContainer = document.getElementById('particles-container');
        if (particlesContainer) {
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                particle.style.left = Math.random() * 100 + 'vw';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.width = Math.random() * 3 + 2 + 'px';
                particle.style.height = particle.style.width;
                particlesContainer.appendChild(particle);
            }
        }
        
        // Create floating hearts (more faded)
        const heartsContainer = document.getElementById('hearts-container');
        if (heartsContainer) {
            for (let i = 0; i < 15; i++) {
                const heart = document.createElement('div');
                heart.classList.add('heart');
                heart.innerHTML = '❤';
                heart.style.left = Math.random() * 100 + 'vw';
                heart.style.animationDelay = Math.random() * 20 + 's';
                heart.style.fontSize = Math.random() * 20 + 8 + 'px';
                heartsContainer.appendChild(heart);
            }
        }
        const flowersContainer = document.getElementById('flowers-container');
        if (flowersContainer) {
            for (let i = 0; i < 15; i++) {
                const heart = document.createElement('div');
                heart.classList.add('heart');
                heart.innerHTML = '🌸';
                heart.style.left = Math.random() * 100 + 'vw';
                heart.style.animationDelay = Math.random() * 20 + 's';
                heart.style.fontSize = Math.random() * 15 + 8 + 'px';
                heartsContainer.appendChild(heart);
            }
        }
        
        // Initialize Arabic fonts and direction
        updateTextDirection('en');
        // Ensure the initial door text is set
        updateDoorText('en');
        
        // Initialize door elements
        console.log("Door functionality initialized");
    </script>
</body>

</html>
